# Racket GUI Plus 项目架构

## 项目概述

Racket GUI Plus 是一个增强的 Racket GUI 控件库，提供现代化的苹果风格 UI 控件集合，支持主题切换和全局刷新。

## 目录结构

```
racket-gui-plus/
├─ src/                               ; 控件实现代码 
│   ├─ gui-plus.rkt                    ; 库主入口，聚合导出所有控件 
│   ├─ style-config.rkt                ; 主题/样式管理 
│   ├─ atomic/                         ; 原子控件 
│   ├─ composite/                      ; 复合控件 
│   ├─ container/                      ; 容器控件 
│   └─ app/                            ; 应用控件 
├─ docs/                               ; 文档、说明、设计约束 
│   ├─ architecture.md 
│   └─ usage.md 
├─ tests/                              ; 测试目录 
│   ├─ atomic/ 
│   ├─ composite/ 
│   └─ container/ 
└─ examples/                            ; 示例和演示脚本
```

## 模块划分

### 1. 核心模块

#### src/gui-plus.rkt
- 库的主入口文件
- 聚合导入所有控件模块
- 统一导出所有公共接口
- 提供向后兼容的别名

#### src/style-config.rkt
- 主题/样式管理
- 定义亮色和暗色主题
- 提供主题切换机制
- 支持全局控件刷新
- 导出样式常量和便捷访问函数

### 2. 控件类型

#### atomic/ - 原子控件
- 基础的、不可再分的UI元素
- 如按钮、标签、文本框等
- 每个控件独立封装，职责单一

#### composite/ - 复合控件
- 由多个原子控件组合而成的控件
- 如过滤按钮、进度条、搜索框等
- 提供更复杂的交互功能

#### container/ - 容器控件
- 用于组织和布局其他控件的容器
- 如侧边栏、分割视图、标签页等
- 管理子控件的布局和事件传递

#### app/ - 应用控件
- 完整的应用级控件或组件
- 如日历、时间选择器、待办事项列表等
- 提供完整的功能模块

## 主题系统

### 主题定义
- 使用 `theme` 结构体定义主题属性
- 包含颜色、字体、尺寸、间距等配置
- 支持亮色和暗色两种预设主题
- 允许自定义主题

### 主题切换机制
- 全局主题参数 `current-theme`
- 主题变更回调函数列表
- 所有控件注册机制，支持全局刷新
- 提供便捷的样式访问函数

## 控件开发规范

1. **继承结构**：控件通常继承自 Racket GUI 库的基础类，如 `canvas%`、`panel%` 等
2. **样式使用**：通过 `style-config.rkt` 提供的函数访问当前主题样式
3. **事件处理**：合理处理鼠标和键盘事件
4. **主题响应**：支持主题切换，在主题变更时自动刷新
5. **接口设计**：提供清晰的初始化参数和回调机制

## 依赖关系

- 主入口 `gui-plus.rkt` 依赖所有控件模块
- 所有控件模块依赖 `style-config.rkt`
- 复合控件可能依赖原子控件
- 容器控件用于组织和布局其他控件

## 扩展机制

1. **添加新控件**：在对应目录下创建新的控件文件
2. **注册控件**：在 `gui-plus.rkt` 中导入并导出新控件
3. **样式扩展**：在 `style-config.rkt` 中添加新的样式属性
4. **主题扩展**：定义新的主题实例

## 最佳实践

1. **单一职责**：每个控件只负责一个特定功能
2. **样式一致性**：使用主题系统提供的样式，确保视觉一致性
3. **事件封装**：提供简洁的事件回调接口
4. **主题响应**：确保控件在主题切换时能正确刷新
5. **文档完善**：为每个控件添加清晰的文档注释

## 性能考量

1. **惰性加载**：控件只在需要时创建
2. **事件优化**：避免不必要的事件处理和刷新
3. **内存管理**：及时释放不再使用的资源
4. **全局刷新**：主题切换时只刷新可见控件

## 测试策略

- 单元测试：测试控件的基本功能和属性
- 集成测试：测试控件组合使用的场景
- 视觉测试：验证控件在不同主题下的显示效果
- 性能测试：测试控件的响应速度和资源占用

## 未来规划

1. **扩展控件库**：添加更多现代化UI控件
2. **增强主题系统**：支持更多主题定制选项
3. **优化性能**：提升控件的渲染和响应速度
4. **完善文档**：提供更详细的使用指南和API文档
5. **增强可访问性**：支持键盘导航和屏幕阅读器
